<ngx-loading [show]="loading" [config]="{ backdropBorderRadius: '3px' }"></ngx-loading>

<div class="card">
    <div class="card-header">
        <i class="fa fa-sitemap"></i> الإدراة <hr>
    </div>
    <form [formGroup]="departmentForm">

        <div class="card-body">
            <div id="icons" class="form-group row mr-3">
                <button type="button" class="btn btn-md" [disabled]="addDisabled" (click)="openAddDialog()"><div class="plus_bold"> + </div></button> 
                &nbsp;&nbsp;
                <button type="button" class="btn btn-md" [disabled]="editDisabled" (click)="openEditDialog()"><div class="plus_bold" > <i class="icon-pencil"></i> </div></button> 
        
                &nbsp;&nbsp;
                <button type="button" class="btn btn-md" [disabled]="deleteDisabled" (click)="deleteDepartment()"><div class="plus_bold" > <i class="icon-trash"></i> </div></button> 
               
            </div>


            <!-- <div class="form-group row">
                <button type="button"
                [disabled]="departmentNames?.length>5"
                class="btn btn-success  btn-circle btn-md" tooltip="add" placement="bottom"
                    (click)="addDeparment()">
                    <div class="plus_bold"> + </div>
                </button>
                &nbsp; &nbsp;
                <button (click)="deleteDept()" 
                [disabled]="departmentNames?.length===1"
                type="button" tooltip="Delete" placement="bottom" class="btn btn-danger btn-circle btn-md">
                    <div class="plus_bold"> <i class="icon-trash"></i> </div>
                </button>


            </div>
            <div formArrayName="department_names">
                <div class="row" >
                    <div class="form-group col-sm-4" *ngFor="let item of departmentNames.controls  ; let pointIndex=index"
                    [formGroupName]="pointIndex"> 
                        <label>Department / اسم القسم</label>
                        <div class="input-group mb-3">
                            <div class="input-group">
                                <input type="text" (blur)="isExsitDepartment($event.target.value)" class="form-control" formControlName="departments" required>
                             
                            </div>
                        </div>
                          <div *ngIf="getValidity(pointIndex)" style="color:red">
                          <b>  department name is required </b>
                        </div>
                    </div>
                </div>
            </div> -->

        </div>
        <!-- <div class="card-footer">
            <div class="row">
                <div class="col text-center">
                    <button type="submit" [disabled]="!departmentForm.valid" class="btn btn-md btn-success">إنشاء شركة</button>
                </div>
            </div>
        </div> -->
        <!-- <app-dept-details [depts]="depts"></app-dept-details> -->
    </form>
    <div>
        <div>

            <table mat-table [dataSource]="depts" class="mat-elevation-z8">
                <ng-container matColumnDef="position">
                  <th class="text-center" mat-header-cell *matHeaderCellDef> رقم سري </th>
                  <td mat-cell *matCellDef="let department"> {{ department.srNo }} </td>
                </ng-container>
                <ng-container matColumnDef="name">
                    <th class="text-center" mat-header-cell *matHeaderCellDef> قسم </th>
                    <td mat-cell *matCellDef="let department"> {{ department.name }} </td>
                </ng-container>
                <ng-container matColumnDef="delete">
                    <th class="text-center" mat-header-cell *matHeaderCellDef>  </th>
                    <td mat-cell *matCellDef="let department">
                        <mat-checkbox (change)="onCheckboxChange($event, department.id)"></mat-checkbox>
                    </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let department; columns: displayedColumns;"></tr>
            </table>
        </div>
    </div>
</div>

